function FrontBase(){}function Auth(){this.maskWrapper=$(".mask-wrapper")}FrontBase.prototype.listenAuthBOxHover=function(){var t=$(".auth-box"),e=$(".user-more-box");t.hover(function(){e.show()},function(){e.hide()})},FrontBase.prototype.run=function(){this.listenAuthBOxHover()},$(function(){(new FrontBase).run()}),Auth.prototype.showEvent=function(){this.maskWrapper.show()},Auth.prototype.hideEvent=function(){this.maskWrapper.hide()},Auth.prototype.listenShowHideEvent=function(){console.log("listenShowHideEvent");var t=this,e=$(".login-btn"),n=$(".register-btn"),o=$(".close-btn"),s=$(".scroll-wrapper");e.click(function(){s.css({left:0}),t.showEvent(),console.log("login")}),n.click(function(){s.css({left:-400}),t.showEvent(),console.log("register")}),o.click(function(){t.hideEvent(),console.log("close")})},Auth.prototype.listenSwitchEvent=function(){$(".switch").click(function(){var t=$(".scroll-wrapper"),e=t.css("left");(e=parseInt(e))<0?t.animate({left:"0"}):t.animate({left:"-400px"})})},Auth.prototype.listenLoginEvent=function(){var s=this,t=$(".signin-group"),o=t.find("input[name='telephone']"),a=t.find("input[name='password']"),i=t.find("input[name='remember']");t.find(".submit-btn").click(function(){var t=o.val(),e=a.val(),n=i.prop("checked");xfzajax.post({url:"/account/login/",data:{telephone:t,password:e,remember:n?1:0},success:function(t){if(200==t.code)s.hideEvent(),window.location.reload();else{var e=t.message;if("string"==typeof e||e.constructor==String)console.log(e);else for(var n in e){var o=e[n][0];console.log(o)}}console.log(t)},fail:function(t){console.log(t)}})})},Auth.prototype.listenImgCaptchaEvent=function(){console.log("listenImgCaptchaEvent");var t=$(".img_captcha");t.click(function(){t.attr("src","/account/img_captcha/?random"+Math.random())})},Auth.prototype.smsSuccessEvent=function(){var t=this,e=$(".sms-captcha-btn");messageBox.showSuccess("短信验证码发送成功!"),e.addClass("disabled");var n=3;e.unbind("click");var o=setInterval(function(){e.text(n+"s"),--n<=0&&(clearInterval(o),e.removeClass("disabled"),e.text("发送验证码"),t.listenSmsCaptchaEvent())},1e3)},Auth.prototype.listenSmsCaptchaEvent=function(){var e=this,n=$('.signup-group input[name="telephone"]'),o=$(".sms-captcha-btn");o.click(function(){var t=n.val();if(!t)return messageBox.showInfo("请输入手机号码!"),e.listenSmsCaptchaEvent();xfzajax.get({url:"/account/sms_captcha/",data:{telephone:t},success:function(t){200==t.code&&(o.addClass("disabled"),e.smsSuccessEvent())},fail:function(t){console.log(t)}})})},Auth.prototype.listenRegisterEvent=function(){var f=$(".signup-group");f.find(".submit-btn").click(function(t){console.log("listenRegisterEvent"),t.preventDefault();var e=f.find("input[name=telephone]"),n=f.find("input[name='username']"),o=f.find("input[name='img_captcha']"),s=f.find("input[name='password1']"),a=f.find("input[name='password2']"),i=f.find("input[name='sms_captcha']"),c=e.val(),r=n.val(),l=o.val(),u=s.val(),p=a.val(),h=i.val();console.log("ajax"),xfzajax.post({url:"/account/register/",data:{telephone:c,username:r,img_captcha:l,password1:u,password2:p,sms_captcha:h},success:function(t){window.location.reload()}})})},Auth.prototype.run=function(){var t=this;t.listenShowHideEvent(),t.listenSwitchEvent(),t.listenLoginEvent(),t.listenImgCaptchaEvent(),t.listenSmsCaptchaEvent(),t.listenRegisterEvent()},$(function(){(new Auth).run()}),$(function(){template&&(template.defaults.imports.timeSince=function(t){var e=new Date(t),n=e.getTime(),o=((new Date).getTime()-n)/1e3;return o<60?"刚刚":60<=o&&o<3600?(minutes=parseInt(o/60),minutes+"分钟前"):3600<=o&&o<86400?(hours=parseInt(o/60/60),hours+"小时前"):86400<=o&&o<2592e3?(days=parseInt(o/60/60/24),days+"天前"):e.getFullYear()+"/"+e.getMonth()+"/"+e.getDay()+" "+e.getHours()+"/"+e.getMinutes()+"/"+e.getSeconds()})});